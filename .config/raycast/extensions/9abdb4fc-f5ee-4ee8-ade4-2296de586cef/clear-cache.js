var d=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var w=Object.prototype.hasOwnProperty;var D=(s,e)=>{for(var t in e)d(s,t,{get:e[t],enumerable:!0})},v=(s,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let c of C(e))!w.call(s,c)&&c!==t&&d(s,c,{get:()=>e[c],enumerable:!(n=y(e,c))||n.enumerable});return s};var J=s=>v(d({},"__esModule",{value:!0}),s);var j={};D(j,{default:()=>h});module.exports=J(j);var A=require("@raycast/api");var a=require("@raycast/api");var m=(0,a.getPreferenceValues)(),O=m.messageLimit?parseInt(m.messageLimit):10,l=(s,e=864e5)=>Date.now()-s>e,o=new a.Cache,S=()=>{o.clear()},p=()=>{if(o.has("accounts")){let s=o.get("accounts");if(s){let{time:e,data:t}=JSON.parse(s);if(!l(e))return t}}},$=s=>p()?.find(e=>e.id===s||e.name===s),k=s=>{o.set("accounts",JSON.stringify({time:Date.now(),data:s}))},g=new a.Cache,L=()=>{g.clear()},i=(s,e)=>{let t=`${s}-${e}`;if(g.has(t)){let n=g.get(t);if(n){let{time:c,data:r}=JSON.parse(n);if(!l(c))return r.slice(0,O)}}return[]},u=(s,e,t)=>{let n=`${e}-${t}`;g.set(n,JSON.stringify({time:Date.now(),data:s}))},N=(s,e,t)=>{let c=[...i(e,t),s];u(c,e,t)},P=(s,e,t,n)=>{let r=i(t,n).map(f=>f.id===s?{...f,...e}:f);u(r,t,n)},W=(s,e,t)=>{let c=i(e,t).filter(r=>r.id!==s);u(c,e,t)},M=Object.freeze({getAccounts:p,setAccounts:k,getAccount:$,invalidateAccounts:S,getMessages:i,setMessages:u,addMessage:N,updateMessage:P,deleteMessage:W,invalidateMessages:L});async function h(){(0,A.closeMainWindow)(),M.invalidateMessages(),M.invalidateAccounts()}
