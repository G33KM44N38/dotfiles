---
- name: DOTFILES config
  hosts: localhost
  connection: local

  tasks:

   - name: Set roles
     ansible.builtin.set_fact:
       run_roles: "{{ ansible_run_tags != ['all'] and ansible_run_tags or default_roles | difference(exclude_roles | default([])) }}"
     tags:
       - always
   
   - name: Display roles
     ansible.builtin.debug:
       var: run_roles
     tags:
       - always
   
   - name: Run roles
     ansible.builtin.include_role:
       apply:
         tags:
           - "{{ roles_item }}"
       name: "{{ roles_item }}"
     loop_control:
       loop_var: roles_item
     with_items: "{{ run_roles }}"
     tags:
       - always

   - name: clone dotfiles
     tags:
      - dotfiles
     ansible.builtin.git:
       repo: https://github.com/G33KM44N38/dotfiles
       dest: ~/.dotfiles
       update: yes
   
   - name: Install exa
     homebrew:
       name: exa
       state: present
       update_homebrew: yes
   
   - name: Install lazydocker
     homebrew:
       name: lazydocker
       state: present
       update_homebrew: yes
   
   - name: Install lazygit
     homebrew:
       name: lazygit
       state: present
       update_homebrew: yes
   
   - name: Install ripgrep
     homebrew:
       name: ripgrep
       state: present
       update_homebrew: yes
   
   - name: Install tmux
     homebrew:
       name: tmux
       state: present
       update_homebrew: yes
   
   - name: Install node
     homebrew:
       name: node
       state: present
       update_homebrew: yes
   
   - name: Install skhd
     homebrew:
       name: skhd
       state: present
       update_homebrew: yes
   
   - name: setup skhd
     ignore_errors: yes
     command: skhd --start-service
   
   - name: Install yabai
     homebrew:
       name: yabai
       state: present
       update_homebrew: yes
   
   - name: setup yabai
     ignore_errors: yes
     command: yabai --start-service
   
   - name: Install fzf
     tags:
      - fzf
     homebrew:
       name: fzf
       state: present
       update_homebrew: yes
   
   - name: Install keybinding
     tags:
      - fzf
     become: yes
     command: echo "$(brew --prefix)/opt/fzf/install" | bash
   
   
